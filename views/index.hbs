<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button
        type="button"
        class="navbar-toggle collapsed"
        data-toggle="collapse"
        data-target="#navbar"
        aria-expanded="false"
        aria-controls="navbar"
      >
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">IMDB</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <form class="navbar-form navbar-right"></form>
    </div>
  </div>
</nav>

<div class="container mt-4">
  <h1 class="page-header">Movie Database</h1>
  <div>
    <!-- SEARCH AND ADD INPUT FIELDS -->
    <div class="container">
      <div class="row">
        <!-- Left column for search input fields -->
        <div class="col-md-6">
          <form>
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Search..." />
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button">Go</button>
              </div>
            </div>
          </form>
        </div>
        <!-- Right column for add input fields and button -->
        <div class="col-md-6">
          <form>
            <div class="form-group">
              <label for="movie">Movie:</label>
              <input type="text" class="form-control" id="movie" placeholder="Enter Movie Name" />
            </div>
            <div class="form-group">
              <label for="year">Year:</label>
              <input type="text" class="form-control" id="year" placeholder="Enter Year" />
            </div>
            <div class="form-group">
              <label for="rank">Rank:</label>
              <input type="text" class="form-control" id="rank" placeholder="Enter Rank" />
            </div>
            <div class="text-center">
              <button type="button" class="btn btn-primary">Add</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div>
    <h2 class="sub-header">Table of Movies</h2>
    <div class="table-responsive">
      <table class="table table-striped" id="moviesTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Movie Name</th>
            <th>Year</th>
            <th>Rank</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {{!-- {{#each rows}}
          <tr>
            <td>{{this.id}}</td>
            <td>{{this.column1}}</td>
            <td>{{this.column2}}</td>
            <td>{{this.column3}}</td>
            <td>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-primary btn-sm" onclick="editRow('{{this.id}}')">Update</button>
                <button type="button" class="btn btn-danger btn-sm" onclick="deleteRow('{{this.id}}')">Delete</button>
              </div>
            </td>
          </tr>
          {{/each}} --}}
        </tbody>
      </table>

      <!-- Initialize DataTables using JavaScript -->
      <script type="text/javascript">
        var movies = [];
        $(document).ready(function () {
          $.ajax({
            url: '/api/getAllMovies',
            method: 'GET',
            processData: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
              for (const movie of data) {
                let movieArray = [];
                for (const val of Object.values(movie)) {
                  movieArray.push(val ? val.toString() : '');
                }
                movies.push(movieArray);
              }
              console.log(movies);
            },
          });

          $('#moviesTable').DataTable({
            paging: true,
            ordering: true,
            searching: true,
            ajax: '/api/getAllMovies',
            columns: [
              { data: 'id' },
              { data: 'name' },
              { data: 'year' },
              { data: 'rank' },
              {
                data: 'id',
                render: function (data, type, row, meta) {
                  return (
                    '<button class="btn btn-danger delete-button" data-id="' +
                    data +
                    '">Delete</button>' +
                    '<button class="btn btn-primary edit-button" data-id="' +
                    data +
                    '">Edit</button>'
                  );
                },
              },
            ],
          });
        });
      </script>
    </div>
  </div>
</div>
